(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ba2d7e6e"],{"0257":function(e,t,i){"use strict";i("b0f6")},6544:function(e,t,i){"use strict";i.r(t);var n=i("7a23");const c={class:"morpion"},a={key:0},s={key:1,class:"grid-wrapper"},o={class:"end-game"};function l(e,t,i,l,r,h){const d=Object(n["R"])("n-h1"),b=Object(n["R"])("n-spin"),j=Object(n["R"])("n-alert"),O=Object(n["R"])("n-button"),u=Object(n["R"])("n-collapse-transition"),m=Object(n["R"])("grid"),g=Object(n["R"])("n-result");return Object(n["I"])(),Object(n["k"])("div",c,[Object(n["n"])(d,null,{default:Object(n["bb"])(()=>[Object(n["m"])("Morpion")]),_:1}),r.isReady?(Object(n["I"])(),Object(n["k"])("div",s,[""===e.outcome?(Object(n["I"])(),Object(n["i"])(m,{key:0})):Object(n["j"])("",!0),Object(n["n"])(u,{show:""!==e.outcome},{default:Object(n["bb"])(()=>[Object(n["l"])("div",o,[Object(n["n"])(g,{status:h.statusEndGame,title:h.titleEndGame,description:h.descriptionEndGame},{footer:Object(n["bb"])(()=>[e.host&&e.outcome?(Object(n["I"])(),Object(n["i"])(O,{key:0,onClick:t[1]||(t[1]=e=>h.restartGame())},{default:Object(n["bb"])(()=>[Object(n["m"])(" Rejouer ")]),_:1})):(Object(n["I"])(),Object(n["i"])(b,{key:1,size:"medium"}))]),_:1},8,["status","title","description"])])]),_:1},8,["show"]),Object(n["n"])(O,{onClick:t[2]||(t[2]=e=>h.quitRoomConfirm(h.quitRoom)),class:"quit-button"},{default:Object(n["bb"])(()=>[Object(n["m"])(" Quitter la partie ")]),_:1})])):(Object(n["I"])(),Object(n["k"])("div",a,[Object(n["n"])(u,{class:"waiting-card",show:r.displayWaitingCard},{default:Object(n["bb"])(()=>[Object(n["n"])(j,{type:"success"},{icon:Object(n["bb"])(()=>[Object(n["n"])(b,{size:"small"})]),default:Object(n["bb"])(()=>[Object(n["m"])(" En attente d'un autre joueur... ")]),_:1}),Object(n["n"])(O,{onClick:t[0]||(t[0]=e=>h.quitRoom())},{default:Object(n["bb"])(()=>[Object(n["m"])(" Annuler ")]),_:1})]),_:1},8,["show"])]))])}i("14d9");var r=i("5502");const h={cellspacing:"0",cellpadding:"0"},d={class:"case-h case-v"},b={key:0,class:"circle"},j={key:1,class:"cross"},O={key:0,class:"circle"},u={key:1,class:"cross"},m={key:0,class:"circle"},g={key:1,class:"cross"},y={class:"case-h case-v"},p={key:0,class:"circle"},k={key:1,class:"cross"},f={key:0,class:"circle"},w={key:1,class:"cross"},v={key:0,class:"circle"},I={key:1,class:"cross"},R={class:"case-h case-v"},C={key:0,class:"circle"},_={key:1,class:"cross"},L={key:0,class:"circle"},V={key:1,class:"cross"},z={key:0,class:"circle"},M={key:1,class:"cross"};function q(e,t,i,c,a,s){const o=Object(n["R"])("n-collapse-transition");return Object(n["I"])(),Object(n["k"])("div",null,[Object(n["n"])(o,{show:a.displayGrid,appear:""},{default:Object(n["bb"])(()=>[Object(n["l"])("table",h,[Object(n["l"])("tbody",null,[Object(n["l"])("tr",d,[Object(n["l"])("td",{class:Object(n["y"])(["cell h-1 w-1",{"h-0-0":a.lineHorizontalTop,"v-0-0":a.lineVerticalLeft,"db-0-0":a.lineDiagonalBack}]),onClick:t[0]||(t[0]=e=>s.placeItem(0,0))},["O"===a.grid_content[0][0]?(Object(n["I"])(),Object(n["k"])("span",b)):Object(n["j"])("",!0),"X"===a.grid_content[0][0]?(Object(n["I"])(),Object(n["k"])("span",j)):Object(n["j"])("",!0)],2),Object(n["l"])("td",{class:Object(n["y"])(["cell h-1 w-2",{"h-0-1":a.lineHorizontalTop,"v-0-1":a.lineVerticalCenter}]),onClick:t[1]||(t[1]=e=>s.placeItem(0,1))},["O"===a.grid_content[0][1]?(Object(n["I"])(),Object(n["k"])("span",O)):Object(n["j"])("",!0),"X"===a.grid_content[0][1]?(Object(n["I"])(),Object(n["k"])("span",u)):Object(n["j"])("",!0)],2),Object(n["l"])("td",{class:Object(n["y"])(["cell h-1 w-3",{"h-0-2":a.lineHorizontalTop,"v-0-2":a.lineVerticalRight,"df-0-2":a.lineDiagonalForward}]),onClick:t[2]||(t[2]=e=>s.placeItem(0,2))},["O"===a.grid_content[0][2]?(Object(n["I"])(),Object(n["k"])("span",m)):Object(n["j"])("",!0),"X"===a.grid_content[0][2]?(Object(n["I"])(),Object(n["k"])("span",g)):Object(n["j"])("",!0)],2)]),Object(n["l"])("tr",y,[Object(n["l"])("td",{class:Object(n["y"])(["cell h-2 w-1",{"h-1-0":a.lineHorizontalCenter,"v-1-0":a.lineVerticalLeft}]),onClick:t[3]||(t[3]=e=>s.placeItem(1,0))},["O"===a.grid_content[1][0]?(Object(n["I"])(),Object(n["k"])("span",p)):Object(n["j"])("",!0),"X"===a.grid_content[1][0]?(Object(n["I"])(),Object(n["k"])("span",k)):Object(n["j"])("",!0)],2),Object(n["l"])("td",{class:Object(n["y"])(["cell h-2 w-2",{"h-1-1":a.lineHorizontalCenter,"v-1-1":a.lineVerticalCenter,"db-1-1":a.lineDiagonalBack,"df-1-1":a.lineDiagonalForward}]),onClick:t[4]||(t[4]=e=>s.placeItem(1,1))},["O"===a.grid_content[1][1]?(Object(n["I"])(),Object(n["k"])("span",f)):Object(n["j"])("",!0),"X"===a.grid_content[1][1]?(Object(n["I"])(),Object(n["k"])("span",w)):Object(n["j"])("",!0)],2),Object(n["l"])("td",{class:Object(n["y"])(["cell h-2 w-3",{"h-1-2":a.lineHorizontalCenter,"v-1-2":a.lineVerticalRight}]),onClick:t[5]||(t[5]=e=>s.placeItem(1,2))},["O"===a.grid_content[1][2]?(Object(n["I"])(),Object(n["k"])("span",v)):Object(n["j"])("",!0),"X"===a.grid_content[1][2]?(Object(n["I"])(),Object(n["k"])("span",I)):Object(n["j"])("",!0)],2)]),Object(n["l"])("tr",R,[Object(n["l"])("td",{class:Object(n["y"])(["cell h-3 w-1",{"h-2-0":a.lineHorizontalBottom,"v-2-0":a.lineVerticalLeft,"df-2-0":a.lineDiagonalForward}]),onClick:t[6]||(t[6]=e=>s.placeItem(2,0))},["O"===a.grid_content[2][0]?(Object(n["I"])(),Object(n["k"])("span",C)):Object(n["j"])("",!0),"X"===a.grid_content[2][0]?(Object(n["I"])(),Object(n["k"])("span",_)):Object(n["j"])("",!0)],2),Object(n["l"])("td",{class:Object(n["y"])(["cell h-3 w-2",{"h-2-1":a.lineHorizontalBottom,"v-2-1":a.lineVerticalCenter}]),onClick:t[7]||(t[7]=e=>s.placeItem(2,1))},["O"===a.grid_content[2][1]?(Object(n["I"])(),Object(n["k"])("span",L)):Object(n["j"])("",!0),"X"===a.grid_content[2][1]?(Object(n["I"])(),Object(n["k"])("span",V)):Object(n["j"])("",!0)],2),Object(n["l"])("td",{class:Object(n["y"])(["cell h-3 w-3",{"h-2-2":a.lineHorizontalBottom,"v-2-2":a.lineVerticalRight,"db-2-2":a.lineDiagonalBack}]),onClick:t[8]||(t[8]=e=>s.placeItem(2,2))},["O"===a.grid_content[2][2]?(Object(n["I"])(),Object(n["k"])("span",z)):Object(n["j"])("",!0),"X"===a.grid_content[2][2]?(Object(n["I"])(),Object(n["k"])("span",M)):Object(n["j"])("",!0)],2)])])])]),_:1},8,["show"])])}var D={methods:{sleep(e){return new Promise(t=>setTimeout(t,e))}}};const H={name:"grid",mixins:[D],data(){return{grid_content:[["","",""],["","",""],["","",""]],displayGrid:!0,loadingMessage:null,infoMessage:null,endLineColor:"#63e2b7",lineHorizontalTop:!1,lineHorizontalCenter:!1,lineHorizontalBottom:!1,lineVerticalLeft:!1,lineVerticalCenter:!1,lineVerticalRight:!1,lineDiagonalBack:!1,lineDiagonalForward:!1}},computed:{...Object(r["c"])("player",["host","turn","socketId","win","playedCell","symbol","enemyPlayer"])},watch:{enemyPlayer(){this.placeEnemyItem()}},mounted(){this.listenPlay(),this.turn?this.createInfoMessage():this.createLoadingMessage()},beforeUnmount(){this.removeMessage()},methods:{...Object(r["b"])("player",["changePlayedCell","changeTurn","changeWin","changeOutcome","changeVictoryWay","emitPlay","listenPlay"]),createLoadingMessage(){this.loadingMessage||(this.loadingMessage=window.$message.loading("L'adversaire prépare son coup",{duration:0}))},createInfoMessage(){this.infoMessage||(this.infoMessage=window.$message.info("A toi de jouer",{duration:0}))},removeMessage(){this.loadingMessage&&(this.loadingMessage.destroy(),this.loadingMessage=null),this.infoMessage&&(this.infoMessage.destroy(),this.infoMessage=null)},placeItem(e,t){this.turn&&""===this.grid_content[e][t]&&(this.removeMessage(),this.grid_content[e][t]="X",this.changePlayedCell([e,t]),this.checkWin(),this.changeTurn(!1),this.emitPlay(),this.win||this.checkEquality()||this.createLoadingMessage())},placeEnemyItem(){if(this.socketId===this.enemyPlayer.socketId)return;if(this.enemyPlayer.turn)return;this.removeMessage();let e=this.enemyPlayer.playedCell;this.grid_content[e[0]][e[1]]="O",this.checkDefeat()||this.checkEquality()||(this.changeTurn(!0),this.createInfoMessage())},checkEquality(){for(const e of this.grid_content)for(const t of e)if(""===t)return!1;return this.gameOver("equality"),!0},checkDefeat(){return!!this.enemyPlayer.win&&(this.endLineColor="#e88080",this.addLine(this.enemyPlayer.victoryWay),this.gameOver("defeat"),!0)},checkWin(){0!==this.enemyPlayer.length&&(this.checkWinHorizontal()||this.checkWinVertical()||this.checkWinDiagonalBack()||this.checkWinDiagonalForward())&&(this.changeWin(!0),this.gameOver("win"))},checkWinHorizontal(){let e=this.playedCell[0];for(let t=0;t<3;t++)if(this.grid_content[e][t]!==this.symbol)return!1;return 0===e&&this.addLine("h-t"),1===e&&this.addLine("h-c"),2===e&&this.addLine("h-b"),!0},checkWinVertical(){let e=this.playedCell[1];for(let t=0;t<3;t++)if(this.grid_content[t][e]!==this.symbol)return!1;return 0===e&&this.addLine("v-l"),1===e&&this.addLine("v-c"),2===e&&this.addLine("v-r"),!0},checkWinDiagonalBack(){for(let e=0;e<3;e++)if(this.grid_content[e][e]!==this.symbol)return!1;return this.addLine("d-b"),!0},checkWinDiagonalForward(){for(let e=0;e<3;e++){let t=2-e;if(this.grid_content[e][t]!==this.symbol)return!1}return this.addLine("d-f"),!0},async gameOver(e){"equality"!==e?await this.sleep(2e3):await this.sleep(1e3),this.displayGrid=!1,this.endLineColor="#63e2b7",this.changeOutcome(e)},addLine(e){"h-t"===e&&(this.lineHorizontalTop=!this.lineHorizontalTop),"h-c"===e&&(this.lineHorizontalCenter=!this.lineHorizontalCenter),"h-b"===e&&(this.lineHorizontalBottom=!this.lineHorizontalBottom),"v-l"===e&&(this.lineVerticalLeft=!this.lineVerticalLeft),"v-c"===e&&(this.lineVerticalCenter=!this.lineVerticalCenter),"v-r"===e&&(this.lineVerticalRight=!this.lineVerticalRight),"d-b"===e&&(this.lineDiagonalBack=!this.lineDiagonalBack),"d-f"===e&&(this.lineDiagonalForward=!this.lineDiagonalForward),this.changeVictoryWay(e)}}},P=()=>{Object(n["X"])(e=>({"73b69fe2":e.endLineColor}))},B=H.setup;H.setup=B?(e,t)=>(P(),B(e,t)):P;var W=H,T=(i("0257"),i("6b0d")),G=i.n(T);const E=G()(W,[["render",q],["__scopeId","data-v-5919e58a"]]);var X=E,F={name:"Morpion",components:{Grid:X},data(){return{isReady:!1,displayWaitingCard:!0,toBack:!1}},computed:{...Object(r["c"])("player",["host","outcome"]),...Object(r["c"])("room",["rooms","roomPlayers","replay"]),statusEndGame(){return"defeat"===this.outcome?"500":"win"===this.outcome?"418":"404"},titleEndGame(){return"defeat"===this.outcome?"Défaite":"win"===this.outcome?"Victoire":"Egalité"},descriptionEndGame(){return"defeat"===this.outcome?"Aïe ! Pourquoi ne pas retenter votre chance ?":"win"===this.outcome?"Trop facile ! Vous prendrez bien un thé ?":"Bizarre... J'était pourtant sûr que vous alliez l'avoir !"}},watch:{rooms(e,t){const i=e.find(e=>e.id===this.$route.query.room);e.length!==t.length&&void 0===i&&this.isReady&&(window.$message.error("Votre adversaire a quitté la partie"),this.quitRoom())},roomPlayers(e){this.watchRoom(e)},replay(e,t){!e||t||this.host||this.resetGame()}},created(){this.host&&this.changeRoomId(this.$route.query.room)},mounted(){this.listenReplay(),this.watchRoom(this.roomPlayers),window.onpopstate=()=>{this.toBack=!0}},beforeRouteLeave(e,t,i){setTimeout(()=>{if(!this.toBack)return i();this.quitRoomConfirm(i)},100)},methods:{...Object(r["b"])("room",["emitLeaveRoom","listenReplay","changeReplay"]),...Object(r["b"])("player",["changeRoomId","emitReplay","changeTurn","changeWin","changeOutcome"]),watchRoom(e){2!==e.length||this.isReady||(this.isReady=!0)},restartGame(){this.emitReplay(),this.resetGame()},resetGame(){let e="defeat"===this.outcome||"equality"===this.outcome&&this.host;this.changeTurn(e),this.changeOutcome(""),this.changeWin(!1),this.changeReplay(!1)},quitRoomConfirm(e){window.$dialog.warning({title:"Quitter la partie ?",content:"Vous êtes certain de vouloir quitter ? Dans ce cas, votre adversaire sera expulsé de la partie...",positiveText:"Oui, je suis sûr",negativeText:"Finalement non",onPositiveClick:()=>{e()}})},quitRoom(){this.toBack=!1,this.changeOutcome(""),this.$router.push({name:"Rooms"})}}};i("aa8b");const $=G()(F,[["render",l],["__scopeId","data-v-7530346a"]]);t["default"]=$},8277:function(e,t,i){},aa8b:function(e,t,i){"use strict";i("8277")},b0f6:function(e,t,i){}}]);
//# sourceMappingURL=chunk-ba2d7e6e.007323fa.js.map