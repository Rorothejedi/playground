"use strict";(self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[]).push([[22],{426:function(e,t,s){s.r(t),s.d(t,{default:function(){return ce}});var i=s(6252),a=s(3577);const o={class:"room"},n={key:0,class:"waiting-card"},r={key:1,class:"game-wrapper"},c={class:"game"},l={class:"end-game"};function h(e,t,s,h,m,d){const u=(0,i.up)("n-h1"),g=(0,i.up)("n-spin"),p=(0,i.up)("n-alert"),y=(0,i.up)("n-button"),k=(0,i.up)("morpion"),w=(0,i.up)("rock-paper-scissors"),_=(0,i.up)("n-collapse-transition"),v=(0,i.up)("n-result");return(0,i.wg)(),(0,i.iD)("div",o,[m.isReady?((0,i.wg)(),(0,i.iD)("div",r,[(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(e.game),1)])),_:1}),(0,i._)("div",c,[(0,i.Wm)(_,{show:""===e.outcome,appear:""},{default:(0,i.w5)((()=>["Morpion"===e.game?((0,i.wg)(),(0,i.j4)(k,{key:0})):"Pierre-papier-ciseaux"===e.game?((0,i.wg)(),(0,i.j4)(w,{key:1})):(0,i.kq)("",!0)])),_:1},8,["show"]),(0,i.Wm)(_,{show:""!==e.outcome,appear:""},{default:(0,i.w5)((()=>[(0,i._)("div",l,[(0,i.Wm)(v,{status:d.statusEndGame,title:d.titleEndGame,description:d.descriptionEndGame},{footer:(0,i.w5)((()=>[e.host&&e.outcome?((0,i.wg)(),(0,i.j4)(y,{key:0,onClick:t[1]||(t[1]=e=>d.restartGame())},{default:(0,i.w5)((()=>[(0,i.Uk)(" Rejouer ")])),_:1})):((0,i.wg)(),(0,i.j4)(g,{key:1,size:"medium"}))])),_:1},8,["status","title","description"])])])),_:1},8,["show"])]),(0,i.Wm)(y,{onClick:t[2]||(t[2]=e=>d.quitRoomConfirm(d.quitRoom)),class:"quit-button"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Quitter la partie ")])),_:1})])):((0,i.wg)(),(0,i.iD)("div",n,[(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(e.game),1)])),_:1}),(0,i.Wm)(p,{type:"success"},{icon:(0,i.w5)((()=>[(0,i.Wm)(g,{size:"small"})])),default:(0,i.w5)((()=>[(0,i.Uk)(" En attente d'un autre joueur... ")])),_:1}),(0,i.Wm)(y,{onClick:t[0]||(t[0]=e=>d.quitRoom())},{default:(0,i.w5)((()=>[(0,i.Uk)(" Annuler ")])),_:1})]))])}s(7658);var m=s(3907),d=s(5834);const u={class:"morpion"},g={cellspacing:"0",cellpadding:"0"},p={key:0,class:"circle"},y={key:1,class:"cross"},k={key:0,class:"circle"},w={key:1,class:"cross"},_={key:0,class:"circle"},v={key:1,class:"cross"},f={key:0,class:"circle"},C={key:1,class:"cross"},D={key:0,class:"circle"},I={key:1,class:"cross"},R={key:0,class:"circle"},q={key:1,class:"cross"},V={key:0,class:"circle"},L={key:1,class:"cross"},b={key:0,class:"circle"},O={key:1,class:"cross"},z={key:0,class:"circle"},M={key:1,class:"cross"};function E(e,t,s,o,n,r){return(0,i.wg)(),(0,i.iD)("div",u,[(0,i._)("table",g,[(0,i._)("tbody",null,[(0,i._)("tr",null,[(0,i._)("td",{class:(0,a.C_)(["h-1 w-1",{"h-0-0":n.lineHorizontalTop,"v-0-0":n.lineVerticalLeft,"db-0-0":n.lineDiagonalBack}]),onClick:t[0]||(t[0]=e=>r.placeItem(0,0))},["O"===n.grid_content[0][0]?((0,i.wg)(),(0,i.iD)("span",p)):(0,i.kq)("",!0),"X"===n.grid_content[0][0]?((0,i.wg)(),(0,i.iD)("span",y)):(0,i.kq)("",!0)],2),(0,i._)("td",{class:(0,a.C_)(["h-1 w-2",{"h-0-1":n.lineHorizontalTop,"v-0-1":n.lineVerticalCenter}]),onClick:t[1]||(t[1]=e=>r.placeItem(0,1))},["O"===n.grid_content[0][1]?((0,i.wg)(),(0,i.iD)("span",k)):(0,i.kq)("",!0),"X"===n.grid_content[0][1]?((0,i.wg)(),(0,i.iD)("span",w)):(0,i.kq)("",!0)],2),(0,i._)("td",{class:(0,a.C_)(["h-1 w-3",{"h-0-2":n.lineHorizontalTop,"v-0-2":n.lineVerticalRight,"df-0-2":n.lineDiagonalForward}]),onClick:t[2]||(t[2]=e=>r.placeItem(0,2))},["O"===n.grid_content[0][2]?((0,i.wg)(),(0,i.iD)("span",_)):(0,i.kq)("",!0),"X"===n.grid_content[0][2]?((0,i.wg)(),(0,i.iD)("span",v)):(0,i.kq)("",!0)],2)]),(0,i._)("tr",null,[(0,i._)("td",{class:(0,a.C_)(["h-2 w-1",{"h-1-0":n.lineHorizontalCenter,"v-1-0":n.lineVerticalLeft}]),onClick:t[3]||(t[3]=e=>r.placeItem(1,0))},["O"===n.grid_content[1][0]?((0,i.wg)(),(0,i.iD)("span",f)):(0,i.kq)("",!0),"X"===n.grid_content[1][0]?((0,i.wg)(),(0,i.iD)("span",C)):(0,i.kq)("",!0)],2),(0,i._)("td",{class:(0,a.C_)(["h-2 w-2",{"h-1-1":n.lineHorizontalCenter,"v-1-1":n.lineVerticalCenter,"db-1-1":n.lineDiagonalBack,"df-1-1":n.lineDiagonalForward}]),onClick:t[4]||(t[4]=e=>r.placeItem(1,1))},["O"===n.grid_content[1][1]?((0,i.wg)(),(0,i.iD)("span",D)):(0,i.kq)("",!0),"X"===n.grid_content[1][1]?((0,i.wg)(),(0,i.iD)("span",I)):(0,i.kq)("",!0)],2),(0,i._)("td",{class:(0,a.C_)(["h-2 w-3",{"h-1-2":n.lineHorizontalCenter,"v-1-2":n.lineVerticalRight}]),onClick:t[5]||(t[5]=e=>r.placeItem(1,2))},["O"===n.grid_content[1][2]?((0,i.wg)(),(0,i.iD)("span",R)):(0,i.kq)("",!0),"X"===n.grid_content[1][2]?((0,i.wg)(),(0,i.iD)("span",q)):(0,i.kq)("",!0)],2)]),(0,i._)("tr",null,[(0,i._)("td",{class:(0,a.C_)(["h-3 w-1",{"h-2-0":n.lineHorizontalBottom,"v-2-0":n.lineVerticalLeft,"df-2-0":n.lineDiagonalForward}]),onClick:t[6]||(t[6]=e=>r.placeItem(2,0))},["O"===n.grid_content[2][0]?((0,i.wg)(),(0,i.iD)("span",V)):(0,i.kq)("",!0),"X"===n.grid_content[2][0]?((0,i.wg)(),(0,i.iD)("span",L)):(0,i.kq)("",!0)],2),(0,i._)("td",{class:(0,a.C_)(["h-3 w-2",{"h-2-1":n.lineHorizontalBottom,"v-2-1":n.lineVerticalCenter}]),onClick:t[7]||(t[7]=e=>r.placeItem(2,1))},["O"===n.grid_content[2][1]?((0,i.wg)(),(0,i.iD)("span",b)):(0,i.kq)("",!0),"X"===n.grid_content[2][1]?((0,i.wg)(),(0,i.iD)("span",O)):(0,i.kq)("",!0)],2),(0,i._)("td",{class:(0,a.C_)(["h-3 w-3",{"h-2-2":n.lineHorizontalBottom,"v-2-2":n.lineVerticalRight,"db-2-2":n.lineDiagonalBack}]),onClick:t[8]||(t[8]=e=>r.placeItem(2,2))},["O"===n.grid_content[2][2]?((0,i.wg)(),(0,i.iD)("span",z)):(0,i.kq)("",!0),"X"===n.grid_content[2][2]?((0,i.wg)(),(0,i.iD)("span",M)):(0,i.kq)("",!0)],2)])])])])}var T={data(){return{infoMessage:null,loadingMessage:null}},beforeUnmount(){this.removeMessage()},methods:{createInfoMessage(e){this.infoMessage||(this.infoMessage=window.$message.info(e,{duration:0}))},createLoadingMessage(e){this.loadingMessage||(this.loadingMessage=window.$message.loading(e,{duration:0}))},removeMessage(){this.loadingMessage&&(this.loadingMessage.destroy(),this.loadingMessage=null),this.infoMessage&&(this.infoMessage.destroy(),this.infoMessage=null)}}},W=s(5359),H=s(9963);const P={name:"Morpion",mixins:[T,W.Z],data(){return{grid_content:[["","",""],["","",""],["","",""]],symbol:"X",enemySymbol:"O",endLineColor:"#63e2b7",lineHorizontalTop:!1,lineHorizontalCenter:!1,lineHorizontalBottom:!1,lineVerticalLeft:!1,lineVerticalCenter:!1,lineVerticalRight:!1,lineDiagonalBack:!1,lineDiagonalForward:!1}},computed:{...(0,m.rn)("player",["socketId","host","turn","isWinner"]),...(0,m.rn)("game",["playedCell","enemyData"]),...(0,m.Se)("room",["enemy"])},watch:{enemyData(){this.placeEnemyItem()}},mounted(){this.listenPlayToMorpion(),this.turn?this.createInfoMessage("A toi de jouer"):this.createLoadingMessage(`${this.enemy.username} prépare son coup`)},methods:{...(0,m.nv)("player",["changeTurn","changeIsWinner","changeOutcome"]),...(0,m.nv)("game",["emitPlayToMorpion","listenPlayToMorpion","changePlayedCell","changeVictoryWay"]),placeItem(e,t){this.turn&&""===this.grid_content[e][t]&&(this.removeMessage(),this.grid_content[e][t]=this.symbol,this.changePlayedCell([e,t]),this.checkVictory(),this.changeTurn(!1),this.emitPlayToMorpion(),this.isWinner||this.checkEquality()||this.createLoadingMessage("L'adversaire prépare son coup"))},placeEnemyItem(){if(0===this.enemyData.length)return;if(this.socketId===this.enemyData.socketId)return;if(this.enemyData.turn)return;this.removeMessage();let e=this.enemyData.playedCell;this.grid_content[e[0]][e[1]]=this.enemySymbol,this.checkDefeat()||this.checkEquality()||(this.changeTurn(!0),this.createInfoMessage("A toi de jouer"))},checkEquality(){for(const e of this.grid_content)for(const t of e)if(""===t)return!1;return this.gameOver("equality"),!0},checkDefeat(){return!!this.enemyData.isWinner&&(this.endLineColor="#e88080",this.addLine(this.enemyData.victoryWay),this.gameOver("defeat"),!0)},checkVictory(){0!==this.enemyData.length&&(this.checkVictoryHorizontal()||this.checkVictoryVertical()||this.checkVictoryDiagonalBack()||this.checkVictoryDiagonalForward())&&(this.changeIsWinner(!0),this.gameOver("victory"))},checkVictoryHorizontal(){let e=this.playedCell[0];for(let t=0;t<3;t++)if(this.grid_content[e][t]!==this.symbol)return!1;return 0===e&&this.addLine("h-t"),1===e&&this.addLine("h-c"),2===e&&this.addLine("h-b"),!0},checkVictoryVertical(){let e=this.playedCell[1];for(let t=0;t<3;t++)if(this.grid_content[t][e]!==this.symbol)return!1;return 0===e&&this.addLine("v-l"),1===e&&this.addLine("v-c"),2===e&&this.addLine("v-r"),!0},checkVictoryDiagonalBack(){for(let e=0;e<3;e++)if(this.grid_content[e][e]!==this.symbol)return!1;return this.addLine("d-b"),!0},checkVictoryDiagonalForward(){for(let e=0;e<3;e++){let t=2-e;if(this.grid_content[e][t]!==this.symbol)return!1}return this.addLine("d-f"),!0},async gameOver(e){"equality"!==e?await this.sleep(2e3):await this.sleep(1e3),this.endLineColor="#63e2b7",this.changeOutcome(e)},addLine(e){"h-t"===e&&(this.lineHorizontalTop=!this.lineHorizontalTop),"h-c"===e&&(this.lineHorizontalCenter=!this.lineHorizontalCenter),"h-b"===e&&(this.lineHorizontalBottom=!this.lineHorizontalBottom),"v-l"===e&&(this.lineVerticalLeft=!this.lineVerticalLeft),"v-c"===e&&(this.lineVerticalCenter=!this.lineVerticalCenter),"v-r"===e&&(this.lineVerticalRight=!this.lineVerticalRight),"d-b"===e&&(this.lineDiagonalBack=!this.lineDiagonalBack),"d-f"===e&&(this.lineDiagonalForward=!this.lineDiagonalForward),this.changeVictoryWay(e)}}},B=()=>{(0,H.sj)((e=>({"1eef6898":e.endLineColor})))},F=P.setup;P.setup=F?(e,t)=>(B(),F(e,t)):B;var S=P,U=s(3744);const x=(0,U.Z)(S,[["render",E],["__scopeId","data-v-f4169682"]]);var G=x,j=s.p+"img/rock.ca4c5aec.svg",X=s.p+"img/paper.acd767a4.svg",$=s.p+"img/scissors.47c9558f.svg",Z=s.p+"img/rock-reverse.5b346b6b.svg",A=s.p+"img/paper-reverse.8ae0df57.svg",Q=s.p+"img/scissors-reverse.4f13ce19.svg";const J={class:"choices"},K={class:"choice"},N={class:"choice"},Y={class:"choice"},ee={class:"endgame"},te={class:"scores"};function se(e,t,s,o,n,r){const c=(0,i.up)("n-collapse-transition"),l=(0,i.up)("n-text");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(c,{show:n.displayChoices},{default:(0,i.w5)((()=>[(0,i._)("div",J,[(0,i._)("div",K,[(0,i._)("img",{src:j,alt:"La pierre",title:"La pierre",onClick:t[0]||(t[0]=e=>r.chooseItem("rock")),class:(0,a.C_)({chosen:"rock"===e.chosenItem,"disabled-item":""!==e.chosenItem}),rel:"preload"},null,2)]),(0,i._)("div",N,[(0,i._)("img",{src:X,alt:"Le papier",title:"Le Papier",onClick:t[1]||(t[1]=e=>r.chooseItem("paper")),class:(0,a.C_)({chosen:"paper"===e.chosenItem,"disabled-item":""!==e.chosenItem}),rel:"preload"},null,2)]),(0,i._)("div",Y,[(0,i._)("img",{src:$,alt:"Les ciseaux",title:"Les ciseaux",onClick:t[2]||(t[2]=e=>r.chooseItem("scissors")),class:(0,a.C_)({chosen:"scissors"===e.chosenItem,"disabled-item":""!==e.chosenItem}),rel:"preload"},null,2)])])])),_:1},8,["show"]),(0,i.Wm)(c,{show:n.displayEndgame},{default:(0,i.w5)((()=>[(0,i._)("div",ee,[(0,i._)("div",null,[(0,i.wy)((0,i._)("img",{src:j,alt:"La pierre",class:(0,a.C_)(n.localOutcome),rel:"preload"},null,2),[[H.F8,"rock"===e.chosenItem]]),(0,i.wy)((0,i._)("img",{src:X,alt:"Le papier",class:(0,a.C_)(n.localOutcome),rel:"preload"},null,2),[[H.F8,"paper"===e.chosenItem]]),(0,i.wy)((0,i._)("img",{src:$,alt:"Les ciseaux",class:(0,a.C_)(n.localOutcome),rel:"preload"},null,2),[[H.F8,"scissors"===e.chosenItem]])]),(0,i.Wm)(l,{italic:""},{default:(0,i.w5)((()=>[(0,i.Uk)("VS")])),_:1}),(0,i._)("div",null,[(0,i.wy)((0,i._)("img",{src:Z,alt:"La pierre",class:(0,a.C_)(r.enemyEndgameColorClass),rel:"preload"},null,2),[[H.F8,"rock"===e.enemyData.chosenItem]]),(0,i.wy)((0,i._)("img",{src:A,alt:"Le papier",class:(0,a.C_)(r.enemyEndgameColorClass),rel:"preload"},null,2),[[H.F8,"paper"===e.enemyData.chosenItem]]),(0,i.wy)((0,i._)("img",{src:Q,alt:"Les ciseaux",class:(0,a.C_)(r.enemyEndgameColorClass),rel:"preload"},null,2),[[H.F8,"scissors"===e.enemyData.chosenItem]])])])])),_:1},8,["show"]),(0,i._)("div",te,[(0,i._)("div",null,[(0,i.Wm)(l,{italic:""},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(e.username),1)])),_:1}),(0,i.Wm)(l,null,{default:(0,i.w5)((()=>[(0,i.Uk)(" - "+(0,a.zw)(e.score),1)])),_:1})]),(0,i._)("div",null,[(0,i.Wm)(l,{italic:""},{default:(0,i.w5)((()=>[(0,i.Uk)((0,a.zw)(void 0!==e.enemy?e.enemy.username:""),1)])),_:1}),(0,i.Wm)(l,null,{default:(0,i.w5)((()=>[(0,i.Uk)(" - "+(0,a.zw)(0!==e.enemyData.length?e.enemyData.score:0),1)])),_:1})])])])}var ie={name:"RockPaperScissors",mixins:[T,W.Z],data(){return{displayChoices:!0,displayEndgame:!1,localOutcome:""}},computed:{...(0,m.rn)("player",["username","score"]),...(0,m.rn)("game",["enemyData","chosenItem","scoreToReach"]),...(0,m.Se)("room",["room","enemy"]),enemyEndgameColorClass(){return"victory"===this.localOutcome?"defeat":"defeat"===this.localOutcome?"victory":"equality"}},watch:{enemyData(e){0!==e.length&&(""===this.chosenItem&&this.createInfoMessage(`${e.username} a choisi son coup`),this.checkResult())}},mounted(){this.listenPlayToRockPaperScissors()},beforeUnmount(){this.resetEnemyData(),this.changeChosenItem(""),this.changeScore(0)},methods:{...(0,m.nv)("player",["changeOutcome","changeScore"]),...(0,m.nv)("game",["emitPlayToRockPaperScissors","listenPlayToRockPaperScissors","changeEnemyData","resetEnemyData","changeChosenItem"]),chooseItem(e){""===this.chosenItem&&(this.changeChosenItem(e),this.emitPlayToRockPaperScissors(),this.checkResult())},checkResult(){if(0===this.enemyData.length||""===this.chosenItem)return;const e=this.enemyData.chosenItem;this.removeMessage(),this.checkEquality(e),this.checkVictory(e),this.checkDefeat(e)},checkEquality(e){("rock"===e&&"rock"===this.chosenItem||"paper"===e&&"paper"===this.chosenItem||"scissors"===e&&"scissors"===this.chosenItem)&&this.roundOver("equality")},checkVictory(e){("rock"===e&&"paper"===this.chosenItem||"paper"===e&&"scissors"===this.chosenItem||"scissors"===e&&"rock"===this.chosenItem)&&(this.changeScore(this.score+1),this.roundOver("victory"))},checkDefeat(e){if("rock"===e&&"scissors"===this.chosenItem||"paper"===e&&"rock"===this.chosenItem||"scissors"===e&&"paper"===this.chosenItem){let e=this.enemyData;e.score=this.enemyData.score+1,this.changeEnemyData(e),this.roundOver("defeat")}},async roundOver(e){this.localOutcome=e,this.displayChoices=!1,this.displayEndgame=!0,await this.sleep(2500);let t=this.enemyData;t.chosenItem="",this.changeEnemyData(t),this.changeChosenItem(""),this.score===this.room.scoreToReach?this.gameOver("victory"):this.enemyData.score===this.room.scoreToReach?this.gameOver("defeat"):(this.displayEndgame=!1,this.displayChoices=!0)},gameOver(e){this.displayChoices=!1,this.changeOutcome(e)}}};const ae=(0,U.Z)(ie,[["render",se],["__scopeId","data-v-62deff91"]]);var oe=ae,ne={name:"Room",title:"Room | Playground",mixins:[d.Z],components:{Morpion:G,RockPaperScissors:oe},data(){return{isReady:!1,toBack:!1}},computed:{...(0,m.rn)("player",["host","outcome"]),...(0,m.rn)("room",["rooms","replay"]),...(0,m.rn)("game",["game"]),statusEndGame(){return"defeat"===this.outcome?"500":"victory"===this.outcome?"418":"404"},titleEndGame(){return"defeat"===this.outcome?"Défaite":"victory"===this.outcome?"Victoire":"Egalité"},descriptionEndGame(){return"defeat"===this.outcome?"Aïe ! Pourquoi ne pas retenter votre chance ?":"victory"===this.outcome?"Trop facile ! Vous prendrez bien un thé ?":"Bizarre... J'était pourtant sûr que vous alliez l'avoir !"}},watch:{rooms(e,t){const s=e.find((e=>e.id===this.$route.query.id));e.length!==t.length&&void 0===s&&this.isReady&&(window.$message.error("Votre adversaire a quitté la partie"),this.quitRoom()),this.watchRoom()},replay(e,t){!e||t||this.host||this.resetGame()}},created(){this.host&&this.changeRoomId(this.$route.query.id)},mounted(){this.listenReplay(),this.watchRoom(),window.onpopstate=()=>{this.toBack=!0}},beforeRouteLeave(e,t,s){setTimeout((()=>{if(!this.toBack)return s();this.quitRoomConfirm(s)}),100)},methods:{...(0,m.nv)("room",["emitReplay","listenReplay","changeReplay"]),...(0,m.nv)("player",["changeRoomId","changeTurn","changeIsWinner","changeOutcome"]),watchRoom(){const e=this.rooms.find((e=>e.id===this.$route.query.id));void 0===e||2!==e.players.length||this.isReady||(this.isReady=!0)},restartGame(){this.emitReplay(),this.resetGame()},resetGame(){let e="defeat"===this.outcome||"equality"===this.outcome&&this.host;this.changeTurn(e),this.changeOutcome(""),this.changeIsWinner(!1),this.changeReplay(!1)},quitRoomConfirm(e){window.$dialog.warning({title:"Quitter la partie ?",content:"Vous êtes certain de vouloir quitter ? Dans ce cas, votre adversaire sera expulsé de la partie...",positiveText:"Oui, je suis sûr",negativeText:"Finalement non",onPositiveClick:()=>{e()}})},quitRoom(){this.toBack=!1,this.changeReplay(!1),this.$router.push({name:"Home"})}}};const re=(0,U.Z)(ne,[["render",h],["__scopeId","data-v-57b646ba"]]);var ce=re}}]);
//# sourceMappingURL=22.cf05266c.js.map